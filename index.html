<!DOCTYPE html>
<html>
<head>
  <title>Filtro de Dados</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h1>Filtro de Dados</h1>
    <input type="text" id="searchInput" class="form-control mt-3" placeholder="Digite o termo de pesquisa...">
    <table class="table table-bordered mt-3">
      <thead>
        <tr>
          <th>Coluna A</th>
          <th>Coluna B</th>
          <!-- Adicione as outras colunas aqui -->
        </tr>
      </thead>
      <tbody id="dataBody">
        <!-- Os dados serão preenchidos aqui -->
      </tbody>
    </table>
  </div>

  <script>
    function updateData(data) {
      const searchInput = document.getElementById('searchInput');
      const dataBody = document.getElementById('dataBody');
      const parsedData = JSON.parse(data);

      searchInput.addEventListener('input', () => {
        const searchTerm = searchInput.value.toLowerCase();
        dataBody.innerHTML = '';

        parsedData.forEach(row => {
          const rowData = row.slice(0, 15); // Considerando colunas A até O
          const match = rowData.some(cell => cell.toLowerCase().includes(searchTerm));
          if (match) {
            const rowHtml = rowData.map(cell => `<td>${cell}</td>`).join('');
            dataBody.innerHTML += `<tr>${rowHtml}</tr>`;
          }
        });
      });
    }

    function fetchData() {
      const url = 'https://script.google.com/macros/s/AKfycbxZR5uoRDTDinyozwb6CKIiEK802cgta2UFQkOGdGkeQgT3ohjwlsv_Nybb1w3FRHm7/exec'; // Substitua pela URL da Web App gerada no Passo 2
      fetch(url)
        .then(response => response.json())
        .then(data => {
          updateData(data);
        })
        .catch(error => console.error('Erro ao buscar dados:', error));
    }

    fetchData();
  </script>
</body>
</html>
