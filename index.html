<!DOCTYPE html>
<html>
<head>
  <title>Filtro de Dados</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h1>Filtro de Dados</h1>
    <input type="text" id="searchInput" class="form-control mt-3" placeholder="Digite o termo de pesquisa...">
    <table class="table table-bordered mt-3">
      <thead>
        <tr>
          <th>Coluna A</th>
          <th>Coluna B</th>
          <!-- Adicione as outras colunas aqui -->
        </tr>
      </thead>
      <tbody id="dataBody">
        <!-- Os dados serão preenchidos aqui -->
      </tbody>
    </table>
  </div>

  <script>
    const SPREADSHEET_ID = '17YYoTpvzocXjQRpeL76buZDEdpKZktp5l2wDwL79bDc';
    const API_KEY = 'AIzaSyBLOUP4v9qIndYOMS7FMmwlfYUX_p8Y5kY';

    function fetchSheetData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/A:O?key=${API_KEY}`;
      fetch(url)
        .then(response => response.json())
        .then(data => {
          const values = data.values;
          const searchInput = document.getElementById('searchInput');
          const dataBody = document.getElementById('dataBody');
          
          searchInput.addEventListener('input', () => {
            const searchTerm = searchInput.value.toLowerCase();
            dataBody.innerHTML = '';

            values.forEach(row => {
              const rowData = row.slice(0, 15); // Considerando colunas A até O
              const match = rowData.some(cell => cell.toLowerCase().includes(searchTerm));
              if (match) {
                const rowHtml = rowData.map(cell => `<td>${cell}</td>`).join('');
                dataBody.innerHTML += `<tr>${rowHtml}</tr>`;
              }
            });
          });
        });
    }

    fetchSheetData();
  </script>
</body>
</html>
