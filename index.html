<!DOCTYPE html>
<html>
<head>
  <title>Filtro de Dados</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h1>Filtro de Dados</h1>
    <input type="text" id="searchInput" class="form-control mt-3" placeholder="Digite o termo de pesquisa...">
    <table class="table table-bordered mt-3">
      <thead>
        <tr>
          <th>Coluna A</th>
          <th>Coluna B</th>
          <!-- Adicione as outras colunas aqui -->
        </tr>
      </thead>
      <tbody id="dataBody">
        <!-- Os dados serão preenchidos aqui -->
      </tbody>
    </table>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <script>
    function updateData(values) {
      const searchInput = document.getElementById('searchInput');
      const dataBody = document.getElementById('dataBody');

      searchInput.addEventListener('input', () => {
        const searchTerm = searchInput.value.toLowerCase();
        dataBody.innerHTML = '';

        values.forEach(row => {
          const rowData = row.slice(0, 15); // Considerando colunas A até O
          const match = rowData.some(cell => cell.toLowerCase().includes(searchTerm));
          if (match) {
            const rowHtml = rowData.map(cell => `<td>${cell}</td>`).join('');
            dataBody.innerHTML += `<tr>${rowHtml}</tr>`;
          }
        });
      });
    }

    function fetchData() {
      const spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSMt3FCnCE6-l1wZx9a7ddYpl6CrxRgbsmRBNtCN1li7eP4qzPzI2dWxy4DLFDg4iZxFQMYLm0P7wB3/pub?gid=0&single=true&output=csv';
      Papa.parse(spreadsheetUrl, {
        download: true,
        header: true,
        dynamicTyping: true,
        complete: function(results) {
          const values = results.data.map(row => Object.values(row));
          updateData(values);
        },
        error: function(error) {
          console.error('Erro ao buscar dados:', error);
        }
      });
    }

    fetchData();
  </script>
</body>
</html>
